const fs = require("fs");
const hre = require("hardhat");

async function main() {
  const [deployer] = await hre.ethers.getSigners();
  console.log("ðŸ“¦ DÃ©ploiement avec le compte :", deployer.address);

  const FanToken = await hre.ethers.getContractFactory("FanToken");
  const fanToken = await FanToken.deploy();
  await fanToken.waitForDeployment();
  const fanTokenAddress = await fanToken.getAddress();
  console.log("âœ… FanToken dÃ©ployÃ© Ã  :", fanTokenAddress);

  const FanNFT = await hre.ethers.getContractFactory("FanNFT");
  const fanNFT = await FanNFT.deploy();
  await fanNFT.waitForDeployment();
  const fanNFTAddress = await fanNFT.getAddress();
  console.log("âœ… FanNFT dÃ©ployÃ© Ã  :", fanNFTAddress);

  // Enregistre les adresses pour le frontend
  const output = {
    fanTokenAddress,
    fanNFTAddress
  };
  fs.writeFileSync("../client/src/contracts.json", JSON.stringify(output, null, 2));
  console.log("ðŸ“ Adresses enregistrÃ©es dans client/src/contracts.json");
}

main().catch((error) => {
  console.error(error);
  process.exitCode = 1;
});
