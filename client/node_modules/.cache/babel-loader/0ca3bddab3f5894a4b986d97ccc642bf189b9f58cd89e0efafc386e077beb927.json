{"ast":null,"code":"// client/src/utils/dao.ts\nimport { ethers } from \"ethers\";\n\n// âœ… Adresse du contrat FanDAO dÃ©ployÃ© localement\nexport const fanDAOAddress = \"0x5FbDB2315678afecb367f032d93F642f64180aa3\";\n\n// âœ… ABI du contrat FanDAO\nexport const fanDAOAbi = [{\n  inputs: [{\n    internalType: \"string\",\n    name: \"description\",\n    type: \"string\"\n  }],\n  name: \"createProposal\",\n  outputs: [],\n  stateMutability: \"nonpayable\",\n  type: \"function\"\n}, {\n  inputs: [],\n  name: \"getProposals\",\n  outputs: [{\n    internalType: \"tuple[]\",\n    name: \"\",\n    type: \"tuple[]\",\n    components: [{\n      internalType: \"uint256\",\n      name: \"id\",\n      type: \"uint256\"\n    }, {\n      internalType: \"string\",\n      name: \"description\",\n      type: \"string\"\n    }, {\n      internalType: \"uint256\",\n      name: \"votes\",\n      type: \"uint256\"\n    }]\n  }],\n  stateMutability: \"view\",\n  type: \"function\"\n}, {\n  inputs: [{\n    internalType: \"uint256\",\n    name: \"proposalId\",\n    type: \"uint256\"\n  }],\n  name: \"voteOnProposal\",\n  outputs: [],\n  stateMutability: \"nonpayable\",\n  type: \"function\"\n}];\n\n// âœ… Initialisation du contrat\nconst getDAOContract = async () => {\n  if (!window.ethereum) throw new Error(\"ðŸ¦Š MetaMask est requis\");\n  const provider = new ethers.BrowserProvider(window.ethereum);\n  const signer = await provider.getSigner();\n  return new ethers.Contract(fanDAOAddress, fanDAOAbi, signer);\n};\n\n// âœ… CrÃ©er une proposition DAO\nexport const createProposal = async description => {\n  const dao = await getDAOContract();\n  const tx = await dao.createProposal(description);\n  await tx.wait();\n  return tx;\n};\n\n// âœ… Obtenir la liste des propositions\nexport const getProposals = async () => {\n  const dao = await getDAOContract();\n  return await dao.getProposals();\n};\n\n// âœ… Voter pour une proposition\nexport const voteOnProposal = async proposalId => {\n  const dao = await getDAOContract();\n  const tx = await dao.voteOnProposal(proposalId);\n  await tx.wait();\n  return tx;\n};","map":{"version":3,"names":["ethers","fanDAOAddress","fanDAOAbi","inputs","internalType","name","type","outputs","stateMutability","components","getDAOContract","window","ethereum","Error","provider","BrowserProvider","signer","getSigner","Contract","createProposal","description","dao","tx","wait","getProposals","voteOnProposal","proposalId"],"sources":["/home/debian/est-fanverse/client/src/utils/dao.ts"],"sourcesContent":["// client/src/utils/dao.ts\nimport { ethers } from \"ethers\";\n\n// âœ… Adresse du contrat FanDAO dÃ©ployÃ© localement\nexport const fanDAOAddress = \"0x5FbDB2315678afecb367f032d93F642f64180aa3\";\n\n// âœ… ABI du contrat FanDAO\nexport const fanDAOAbi = [\n  {\n    inputs: [{ internalType: \"string\", name: \"description\", type: \"string\" }],\n    name: \"createProposal\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\"\n  },\n  {\n    inputs: [],\n    name: \"getProposals\",\n    outputs: [\n      {\n        internalType: \"tuple[]\",\n        name: \"\",\n        type: \"tuple[]\",\n        components: [\n          { internalType: \"uint256\", name: \"id\", type: \"uint256\" },\n          { internalType: \"string\", name: \"description\", type: \"string\" },\n          { internalType: \"uint256\", name: \"votes\", type: \"uint256\" }\n        ]\n      }\n    ],\n    stateMutability: \"view\",\n    type: \"function\"\n  },\n  {\n    inputs: [{ internalType: \"uint256\", name: \"proposalId\", type: \"uint256\" }],\n    name: \"voteOnProposal\",\n    outputs: [],\n    stateMutability: \"nonpayable\",\n    type: \"function\"\n  }\n];\n\n// âœ… Initialisation du contrat\nconst getDAOContract = async (): Promise<ethers.Contract> => {\n  if (!window.ethereum) throw new Error(\"ðŸ¦Š MetaMask est requis\");\n  const provider = new ethers.BrowserProvider(window.ethereum);\n  const signer = await provider.getSigner();\n  return new ethers.Contract(fanDAOAddress, fanDAOAbi, signer);\n};\n\n// âœ… CrÃ©er une proposition DAO\nexport const createProposal = async (description: string): Promise<ethers.Transaction> => {\n  const dao = await getDAOContract();\n  const tx = await dao.createProposal(description);\n  await tx.wait();\n  return tx;\n};\n\n// âœ… Obtenir la liste des propositions\nexport const getProposals = async (): Promise<{ id: bigint; description: string; votes: bigint }[]> => {\n  const dao = await getDAOContract();\n  return await dao.getProposals();\n};\n\n// âœ… Voter pour une proposition\nexport const voteOnProposal = async (proposalId: number): Promise<ethers.Transaction> => {\n  const dao = await getDAOContract();\n  const tx = await dao.voteOnProposal(proposalId);\n  await tx.wait();\n  return tx;\n};\n"],"mappings":"AAAA;AACA,SAASA,MAAM,QAAQ,QAAQ;;AAE/B;AACA,OAAO,MAAMC,aAAa,GAAG,4CAA4C;;AAEzE;AACA,OAAO,MAAMC,SAAS,GAAG,CACvB;EACEC,MAAM,EAAE,CAAC;IAAEC,YAAY,EAAE,QAAQ;IAAEC,IAAI,EAAE,aAAa;IAAEC,IAAI,EAAE;EAAS,CAAC,CAAC;EACzED,IAAI,EAAE,gBAAgB;EACtBE,OAAO,EAAE,EAAE;EACXC,eAAe,EAAE,YAAY;EAC7BF,IAAI,EAAE;AACR,CAAC,EACD;EACEH,MAAM,EAAE,EAAE;EACVE,IAAI,EAAE,cAAc;EACpBE,OAAO,EAAE,CACP;IACEH,YAAY,EAAE,SAAS;IACvBC,IAAI,EAAE,EAAE;IACRC,IAAI,EAAE,SAAS;IACfG,UAAU,EAAE,CACV;MAAEL,YAAY,EAAE,SAAS;MAAEC,IAAI,EAAE,IAAI;MAAEC,IAAI,EAAE;IAAU,CAAC,EACxD;MAAEF,YAAY,EAAE,QAAQ;MAAEC,IAAI,EAAE,aAAa;MAAEC,IAAI,EAAE;IAAS,CAAC,EAC/D;MAAEF,YAAY,EAAE,SAAS;MAAEC,IAAI,EAAE,OAAO;MAAEC,IAAI,EAAE;IAAU,CAAC;EAE/D,CAAC,CACF;EACDE,eAAe,EAAE,MAAM;EACvBF,IAAI,EAAE;AACR,CAAC,EACD;EACEH,MAAM,EAAE,CAAC;IAAEC,YAAY,EAAE,SAAS;IAAEC,IAAI,EAAE,YAAY;IAAEC,IAAI,EAAE;EAAU,CAAC,CAAC;EAC1ED,IAAI,EAAE,gBAAgB;EACtBE,OAAO,EAAE,EAAE;EACXC,eAAe,EAAE,YAAY;EAC7BF,IAAI,EAAE;AACR,CAAC,CACF;;AAED;AACA,MAAMI,cAAc,GAAG,MAAAA,CAAA,KAAsC;EAC3D,IAAI,CAACC,MAAM,CAACC,QAAQ,EAAE,MAAM,IAAIC,KAAK,CAAC,wBAAwB,CAAC;EAC/D,MAAMC,QAAQ,GAAG,IAAId,MAAM,CAACe,eAAe,CAACJ,MAAM,CAACC,QAAQ,CAAC;EAC5D,MAAMI,MAAM,GAAG,MAAMF,QAAQ,CAACG,SAAS,CAAC,CAAC;EACzC,OAAO,IAAIjB,MAAM,CAACkB,QAAQ,CAACjB,aAAa,EAAEC,SAAS,EAAEc,MAAM,CAAC;AAC9D,CAAC;;AAED;AACA,OAAO,MAAMG,cAAc,GAAG,MAAOC,WAAmB,IAAkC;EACxF,MAAMC,GAAG,GAAG,MAAMX,cAAc,CAAC,CAAC;EAClC,MAAMY,EAAE,GAAG,MAAMD,GAAG,CAACF,cAAc,CAACC,WAAW,CAAC;EAChD,MAAME,EAAE,CAACC,IAAI,CAAC,CAAC;EACf,OAAOD,EAAE;AACX,CAAC;;AAED;AACA,OAAO,MAAME,YAAY,GAAG,MAAAA,CAAA,KAA2E;EACrG,MAAMH,GAAG,GAAG,MAAMX,cAAc,CAAC,CAAC;EAClC,OAAO,MAAMW,GAAG,CAACG,YAAY,CAAC,CAAC;AACjC,CAAC;;AAED;AACA,OAAO,MAAMC,cAAc,GAAG,MAAOC,UAAkB,IAAkC;EACvF,MAAML,GAAG,GAAG,MAAMX,cAAc,CAAC,CAAC;EAClC,MAAMY,EAAE,GAAG,MAAMD,GAAG,CAACI,cAAc,CAACC,UAAU,CAAC;EAC/C,MAAMJ,EAAE,CAACC,IAAI,CAAC,CAAC;EACf,OAAOD,EAAE;AACX,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}